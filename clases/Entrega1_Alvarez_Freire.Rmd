```{r}
bw.loocv = function(x, grilla.h = NA, K = dnorm) {
  n = length(x)
  if (is.na(grilla.h)) {
    silverman <- bw.nrd0(x) 
    grilla.h <- seq(silverman * 10^(-2), silverman * 10^2, length.out = 100)
  }
  logf = matrix(NA, n, length(grilla.h))
  for (i in 1:n) {
    print(sum(K((x - x[i]) / n)))
    logf[i, ] = sum(K((x - x[i]) / n)) / ((n-1)*grilla.h)
  }
  return(c(h.CV = grilla.h[which.max(loglikes)], grilla.h = grilla.h, loglikes = loglikes))
}
```
